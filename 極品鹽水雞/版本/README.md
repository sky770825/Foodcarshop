# 極品鹽水雞線上訂單系統

## 📋 系統簡介

這是一個專為餐車設計的線上訂單系統，讓顧客可以透過網頁預訂餐點，訂單自動儲存到 Google 試算表，方便管理和統計。

### 主要功能
- ✅ 線上選購主餐和配菜
- ✅ 自訂口味（辣度、鹹度、檸檬、蔥泥）
- ✅ 選擇去骨或保留骨頭
- ✅ 即時計算訂單總額
- ✅ 自動生成訂單編號
- ✅ 訂單自動儲存到 Google 試算表
- ✅ 手機/平板/電腦響應式設計

---

## 🏗️ 系統架構

```
前端表單 (my_preview (3).html)
    ↓ FormData POST 請求
Google Apps Script (Web 應用程式)
    ↓ 寫入資料
Google Sheets (試算表)
```

### 技術棧
- **前端**：HTML5 + CSS3 + Vanilla JavaScript
- **後端**：Google Apps Script
- **資料庫**：Google Sheets
- **部署**：靜態 HTML（可用任何瀏覽器開啟）

---

## 📂 檔案結構

```
餐車表單收費製/
├── my_preview (3).html          # 主要訂單表單
├── README.md                     # 本說明文件
└── 極品鹽水雞/
    ├── 品項.jpeg                 # 品項圖片
    └── 菜單.jpeg                 # 菜單圖片
```

---

## 🚀 部署指南

### 1. Google 試算表設定

**試算表 ID**：`1rN8VVnChz8SIW-4fAAFsoLd_Hb4wT8nS-p2hKpAI5jw`

**試算表連結**：
https://docs.google.com/spreadsheets/d/1rN8VVnChz8SIW-4fAAFsoLd_Hb4wT8nS-p2hKpAI5jw/edit

### 2. Google Apps Script 部署

#### 步驟 A：建立腳本
1. 開啟試算表
2. 點擊「擴充功能」→「Apps Script」
3. 貼上腳本代碼（見下方）
4. 儲存專案（Ctrl+S）

#### 步驟 B：部署為 Web 應用程式
1. 點擊「部署」→「新增部署作業」
2. 選擇類型：「網頁應用程式」
3. 設定：
   - **執行身分**：我
   - **具有存取權的使用者**：所有人
4. 點擊「部署」
5. 授權應用程式
6. 複製「網頁應用程式」URL

**目前部署 URL**：
```
https://script.google.com/macros/s/AKfycbw_RoLScHz2u0IUkRPu_Yh-yGsDFz7kNHF2pz6S4-8CuaXyzvqaYcE2oZ5up_BK5A_9/exec
```

#### 步驟 C：更新版本
如需更新腳本：
1. 修改代碼並儲存
2. 點擊「部署」→「管理部署作業」
3. 點擊 ✏️ 編輯
4. 版本：選擇「新版本」
5. 點擊「部署」

### 3. HTML 表單設定

1. 確認 HTML 中的 `GAS_ENDPOINT` 使用正確的部署 URL（第 805 行）
2. 用瀏覽器開啟 `my_preview (3).html` 即可使用

---

## 💰 價格設定

### 主餐（每份 $150）
- 鹽水半雞
- 煙燻半雞
- 油雞腿
- 油雞胸

### 單點配菜（每份 $30）

**葉菜類**：花椰菜、龍鬚菜、高麗菜、娃娃菜

**瓜類**：綠苦瓜、小黃瓜

**菇類**：金針菇、杏鮑菇、鮮香菇、黑木耳

**根莖類**：玉米筍、筍白筍、白蘿蔔、紅蘿蔔、洋蔥、蓮藕、脆筍片

**豆製品**：豆皮、百頁豆腐、小豆干

**加工品**：米血糕、小貢丸、甜不辣、黑輪

**其他**：四季豆、海帶根、皮蛋、鵪鶉蛋、雞皮、雞冠、雞蛋黃、雞蛋腸

### 修改價格
如需調整價格，請編輯 HTML 第 742-745 行：

```javascript
const PRICE = {
  main: 150,  // 主餐價格
  side: 30    // 配菜價格
};
```

---

## 📊 試算表欄位說明

| 欄位 | 說明 | 範例 |
|------|------|------|
| 時間戳記 | 訂單送出時間 | 2025-10-09T13:23:00.662Z |
| 訂單編號 | 自動生成唯一編號 | ORD12345678 |
| 姓名 | 顧客姓名 & 群組ID | 王小明 #A123 |
| 電話 | 聯絡電話（末3碼或全碼） | 123 或 0912345678 |
| 取餐方式 | 現場自取 / 託人代取 | 現場自取 |
| 預計取餐時間 | 顧客選擇的時間 | 18:00 |
| 訂單明細 | 所有商品列表 | 鹽水半雞 x1 / 花椰菜 x2 |
| 總金額 | 訂單總價 | 210 |
| 口味 | 口味偏好 | 不辣、正常、加檸檬、加蔥泥 |
| 去骨選項 | 主餐的去骨設定 | 鹽水半雞:去骨 |
| 備註 | 顧客額外說明 | 不吃香菜 |
| 來源 | 訂單來源 | web |

---

## 🎨 界面特色

### 響應式設計
- **手機**：2 欄商品網格
- **平板**：3 欄商品網格
- **電腦**：4 欄商品網格

### 用戶體驗
- ✅ 商品圖片點擊放大
- ✅ 即時計算訂單總額
- ✅ 訂單預覽功能
- ✅ 分類可摺疊設計
- ✅ 表單驗證提示
- ✅ 成功/錯誤訊息提示

### 視覺設計
- 主色調：橙色系（#d97706）
- 圓角設計
- 柔和陰影
- 平滑過渡動畫

---

## 🔧 維護與更新

### 更新商品項目

編輯 HTML 第 748-802 行：

```javascript
// 主餐項目
const MAIN_ITEMS = [
  { name: "鹽水半雞", img: "圖片URL" },
  // ... 更多項目
];

// 配菜項目（依分類）
const SIDE_ITEMS = {
  "葉菜類": [
    { name: "花椰菜", img: "圖片URL" },
    // ... 更多項目
  ],
  // ... 更多分類
};
```

### 更新口味選項

編輯 HTML 第 656-688 行的 select 元素

### 更新菜單圖片

編輯 HTML 第 570-576 行：

```html
<img src="您的圖片URL" alt="菜單1" class="menu-image" />
```

**目前使用的圖片**：
- 菜單1：https://i.postimg.cc/FKLFbHb9/image.jpg
- 菜單2：https://i.postimg.cc/TwvdtvQ1/image.jpg

---

## 🧪 測試流程

### 1. 測試 Google Apps Script
```javascript
// 在 Apps Script 中執行
manualTestDirect()
```
檢查試算表是否新增測試訂單

### 2. 測試 API 端點
在瀏覽器開啟部署 URL，應看到：
```json
{
  "status": "ok",
  "message": "🍗 極品鹽水雞訂單系統運作中",
  "timestamp": "...",
  "version": "1.5"
}
```

### 3. 測試完整流程
1. 開啟 HTML 表單
2. 填寫訂單資料
3. 送出訂單
4. 檢查試算表

---

## ❓ 常見問題

### Q1: 訂單送出後顯示「連線失敗」？
**A**: 檢查以下項目：
1. Google Apps Script 是否正確部署
2. HTML 中的 `GAS_ENDPOINT` 是否正確
3. 部署時是否選擇「執行身分：我」和「存取權：所有人」

### Q2: 試算表沒有收到訂單？
**A**: 
1. 檢查 Apps Script 執行記錄（左側「執行作業」）
2. 確認試算表 ID 是否正確
3. 執行 `manualTestDirect()` 測試連接

### Q3: 如何修改價格？
**A**: 修改 HTML 第 742-745 行的 `PRICE` 物件，無需更新 Google Apps Script

### Q4: 如何新增商品？
**A**: 修改 HTML 第 748-802 行的 `MAIN_ITEMS` 或 `SIDE_ITEMS`

### Q5: 如何自訂欄寬？
**A**: 系統已停用自動調整欄寬，請直接在試算表中手動調整

---

## 🔄 版本歷史

### v1.5 (2025-10-09)
- ✅ 優化口味格式（移除重複標籤）
- ✅ 移除自動調整欄寬功能
- ✅ 改用 FormData 提交（提升相容性）

### v1.4 (2025-10-09)
- ✅ 加強錯誤處理和日誌記錄
- ✅ 支援多種數據格式解析
- ✅ 完整的部署指南

### v1.0-1.3
- ✅ 初始版本開發
- ✅ 基礎功能實現
- ✅ UI/UX 優化

---

## 📞 技術支援

### 開發者工具除錯
1. 按 F12 開啟開發者工具
2. 切換到 Console 標籤
3. 查看錯誤訊息

### Google Apps Script 日誌
1. 開啟 Apps Script 編輯器
2. 點擊左側「執行作業」⏱️
3. 查看最新執行記錄

---

## 📝 授權與使用

此系統為客製化專案，僅供內部使用。

---

## 🎯 未來改進建議

- [ ] 新增訂單查詢功能
- [ ] 新增後台訂單管理介面
- [ ] 支援多種付款方式
- [ ] 新增訂單狀態追蹤
- [ ] 匯出每日統計報表
- [ ] 整合 LINE Notify 通知
- [ ] 新增會員系統

---

**最後更新**：2025-10-09
**系統版本**：v1.5
**狀態**：✅ 運作中

