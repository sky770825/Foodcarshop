# 六蒜包·餐車訂購表單 - 多場地工作表設置指南

## 📊 Google Sheets ID

```
1gf21nUj_4HTLK0zVgAb2CsHbRxcphQFdoe2LpJydjGg
```

---

## 🎯 工作表結構總覽

### 必須建立的工作表：

1. **場地清單** ⭐（核心）
2. **系統設定**
3. **各場地的庫存管理表**（動態建立）
4. **各場地的訂單記錄表**（動態建立）

---

## 📋 工作表 1：場地清單 ⭐

### 用途
定義所有營業場地，系統會根據這個表自動找對應的庫存和訂單表

### 建立步驟

1. **新增工作表，命名為：`場地清單`**

2. **設置標題行（A1:C1）**
```
A1: 場地代碼
B1: 場地名稱  
C1: 狀態
```

3. **填入場地數據（從第2行開始）**

範例：
```
venue_A	中山店	營業中
venue_B	板橋店	營業中
venue_C	新竹店	營業中
```

### 欄位說明

| 欄位 | 必填 | 格式 | 說明 | 範例 |
|------|------|------|------|------|
| A - 場地代碼 | ✅ | venue_X | 唯一識別碼 | venue_A |
| B - 場地名稱 | ✅ | 文字 | 完整名稱 | 中山店 |
| C - 狀態 | 選填 | 文字 | 營業中/暫停 | 營業中 |

### ⚠️ 重要規則

- **場地代碼格式：** `venue_` + 英文字母（A-Z）
- **場地名稱：** 會用來生成工作表名稱，例如「中山店」→「中山店_庫存管理」
- **不要使用特殊符號**（如 `/`, `\`, `*`, `[`, `]` 等）

---

## 📋 工作表 2：系統設定

### 建立步驟

1. **新增工作表，命名為：`系統設定`**

2. **設置內容（A1:B1 開始）**

```
設定項目	值
暫停接單	否
取餐時間_開始	14
取餐時間_結束	20
取餐時間_間隔	5
取餐方式	現場自取,託人代取
```

### 設定說明

| 設定項目 | 說明 | 範例 |
|---------|------|------|
| 暫停接單 | 是/否 | 否 |
| 取餐時間_開始 | 開始小時（24小時制） | 14 |
| 取餐時間_結束 | 結束小時 | 20 |
| 取餐時間_間隔 | 分鐘間隔 | 5 |
| 取餐方式 | 逗號分隔 | 現場自取,託人代取 |

---

## 📋 工作表 3：各場地的庫存管理 ⭐

### 命名規則

**格式：** `{場地名稱}_庫存管理`

**範例：**
- 中山店 → `中山店_庫存管理`
- 板橋店 → `板橋店_庫存管理`
- 新竹店 → `新竹店_庫存管理`

### 建立步驟

**為每個場地建立一個庫存管理表：**

1. **新增工作表**
2. **命名為：`{場地名稱}_庫存管理`**（與場地清單的 B 欄一致）

3. **設置標題行（A1:G1）**
```
A1: 商品名稱
B1: 類型
C1: 當前庫存
D1: 初始庫存
E1: 狀態
F1: 分類
G1: 圖片網址
```

4. **填入商品數據（從第2行開始）**

範例（六蒜包商品）：
```
六蒜包	main	100	100	正常	烘焙	https://...
丹麥手撕包	main	80	80	正常	烘焙	https://...
千層生乳吐司	main	50	50	正常	烘焙	https://...
金磚吐司	main	60	60	正常	烘焙	https://...
千層蛋塔	side	100	100	正常	甜點	https://...
香濃乳酪酥	side	80	80	正常	甜點	https://...
脆皮奶油烤年糕	side	150	150	正常	甜點	https://...
```

### 欄位說明

| 欄位 | 必填 | 格式 | 說明 | 範例 |
|------|------|------|------|------|
| A - 商品名稱 | ✅ | 文字 | 商品完整名稱 | 六蒜包 |
| B - 類型 | ✅ | main/side | 主餐或配菜 | main |
| C - 當前庫存 | ✅ | 數字 | 即時庫存量 | 100 |
| D - 初始庫存 | ✅ | 數字 | 每日初始量 | 100 |
| E - 狀態 | 選填 | 文字 | 正常/缺貨 | 正常 |
| F - 分類 | 選填 | 文字 | 商品分類 | 烘焙 |
| G - 圖片網址 | 選填 | URL | 商品圖片 | https://... |

### 功能說明

- **當前庫存（C欄）：** 每次訂單會自動扣減
- **初始庫存（D欄）：** 用於每日重置
- **一鍵重置：** 在 Apps Script 選單 → 📦 庫存管理 → 🔄 一鍵重置所有場地庫存

---

## 📋 工作表 4：各場地的訂單記錄 ⭐

### 命名規則

**格式：** `{場地名稱}_訂單記錄`

**範例：**
- 中山店 → `中山店_訂單記錄`
- 板橋店 → `板橋店_訂單記錄`
- 新竹店 → `新竹店_訂單記錄`

### 建立步驟

**為每個場地建立一個訂單記錄表：**

1. **新增工作表**
2. **命名為：`{場地名稱}_訂單記錄`**

3. **設置標題行（A1:P1）**

```
A1: 訂單時間
B1: 訂單編號
C1: 姓名&群組ID
D1: 手機號碼
E1: 取餐方式
F1: 取餐時間
G1: 商品詳情
H1: 總額
I1: 口味選項
J1: 去骨選項
K1: 備註
L1: 商品交接進度
M1: 訂單狀況
N1: 來源
O1: 訂單摘要
P1: 場地名稱
```

### 欄位說明（16欄）

| 欄位 | 說明 | 自動填入 |
|------|------|---------|
| A | 訂單時間 | ✅ |
| B | 訂單編號（格式：MMdd-場地代碼-序號） | ✅ |
| C | 姓名&群組ID | ✅ |
| D | 手機號碼 | ✅ |
| E | 取餐方式 | ✅ |
| F | 取餐時間 | ✅ |
| G | 商品詳情 | ✅ |
| H | 總額 | ✅ |
| I | 口味選項 | ✅ |
| J | 去骨選項 | ✅ |
| K | 備註 | ✅ |
| L | 商品交接進度 | - |
| M | 訂單狀況 | ✅ |
| N | 來源 | ✅ |
| O | 訂單摘要 | ✅ |
| P | 場地名稱 | ✅ |

### 訂單編號格式

**格式：** `MMdd-場地代碼-序號`

**範例：**
- 中山店（venue_A）：`1019-A-001`, `1019-A-002`
- 板橋店（venue_B）：`1019-B-001`, `1019-B-002`
- 新竹店（venue_C）：`1019-C-001`, `1019-C-002`

---

## ✅ 快速設置範例

### 假設您有 3 個場地：

1. **場地清單**
```
venue_A	中山店	營業中
venue_B	板橋店	營業中
venue_C	新竹店	暫停
```

2. **需要建立的工作表：**

| 工作表名稱 | 類型 |
|-----------|------|
| 場地清單 | 核心 |
| 系統設定 | 核心 |
| 中山店_庫存管理 | 場地 A |
| 中山店_訂單記錄 | 場地 A |
| 板橋店_庫存管理 | 場地 B |
| 板橋店_訂單記錄 | 場地 B |
| 新竹店_庫存管理 | 場地 C |
| 新竹店_訂單記錄 | 場地 C |

**總共：** 8 個工作表

---

## 🔄 系統運作流程

### 訂單流程

1. 客戶在前端選擇「中山店」
2. 前端發送 `venue=venue_A` 到後端
3. 後端查詢「場地清單」，找到 `venue_A` → 中山店
4. 檢查「中山店_庫存管理」的庫存
5. 扣減「中山店_庫存管理」的庫存
6. 新增訂單到「中山店_訂單記錄」
7. 訂單編號：`1019-A-001`

### 庫存管理流程

1. 營業結束後
2. 在 Apps Script 選單點擊「🔄 一鍵重置所有場地庫存」
3. 系統自動將所有場地的「當前庫存（C欄）」恢復為「初始庫存（D欄）」

---

## 📝 建立檢查清單

### 核心工作表
- [ ] 場地清單（已填入所有場地）
- [ ] 系統設定（已填入所有設定）

### 場地 A（例如：中山店）
- [ ] {場地名}_庫存管理（已填入商品）
- [ ] {場地名}_訂單記錄（標題行已設置）

### 場地 B（例如：板橋店）
- [ ] {場地名}_庫存管理（已填入商品）
- [ ] {場地名}_訂單記錄（標題行已設置）

### 場地 C（例如：新竹店）
- [ ] {場地名}_庫存管理（已填入商品）
- [ ] {場地名}_訂單記錄（標題行已設置）

---

## 🎯 常見問題

### Q1: 場地名稱可以用中文嗎？
**A:** 可以！場地名稱（B欄）可以用中文，但場地代碼（A欄）必須是 `venue_X` 格式。

### Q2: 如何新增場地？
**A:** 
1. 在「場地清單」新增一行
2. 建立 `{場地名}_庫存管理` 工作表
3. 建立 `{場地名}_訂單記錄` 工作表
4. 填入商品數據

### Q3: 每個場地的商品可以不同嗎？
**A:** 可以！每個場地的庫存管理表可以有不同的商品。

### Q4: 訂單會混在一起嗎？
**A:** 不會！每個場地有獨立的訂單記錄表，訂單編號也包含場地代碼。

### Q5: 如何關閉某個場地？
**A:** 在「場地清單」將該場地的「狀態」改為「暫停」，前端就不會顯示該場地。

---

## 🚀 下一步

完成工作表設置後：

1. **部署 Google Apps Script**
   - 複製 `Google_Apps_Script_後端_多場地版.js` 內容
   - 貼到 Apps Script 編輯器
   - 部署為「網頁應用程式」

2. **更新前端**
   - 將 GAS API 網址填入 `index.html`

3. **測試**
   - 選擇不同場地下單
   - 檢查對應的訂單記錄表
   - 檢查庫存是否正確扣減

---

**最後更新：2025-10-19**
**版本：多場地完整版 v1.0**

