# 六蒜包·餐車訂購表單 - 部署指南

## 📋 已完成的更新

✅ **品牌信息**
- 標題：極品鹽水雞 → 六蒜包·餐車
- Logo：更新為麵包圖片
- 網站ID：WEB001 → WEB002

✅ **商品結構**
- 從「主餐+配菜」改為「統一商品列表」
- 商品類型：鹽水雞 → 烘焙糕點（六蒜包、丹麥手撕包等）
- 移除「去骨」選項（烘焙商品不需要）

✅ **表單簡化**
- 移除「口味客製」區塊（辣度、鹹度、檸檬、蒜泥）
- 只保留「備註說明」欄位

✅ **價格邏輯**
- 改為每個商品獨立價格（從 `data-price` 讀取）
- 支援從後端動態載入商品價格

---

## 🚀 部署步驟

### 1. 建立 Google Sheets

您的 Google Sheets **已有** 以下工作表：

#### ✅ **工作表1：Form Responses 1**（已存在）
訂單表單回應，系統會自動寫入新訂單

#### ✅ **工作表2：商品圖價格**（已存在，gid=1078174424）
**這是最重要的工作表！**

**欄位結構：**
| A | B | C | D |
|---|---|---|---|
| 商品名稱 | 價格 | 狀態 | 圖片連結 |
| 六蒜包 | 45 | 正常 | https://... |
| 丹麥手撕包 | 50 | 正常 | https://... |

**⚠️ 請確保：**
- 第1行是標題行（系統會跳過）
- A欄：商品名稱（必填）
- B欄：價格（必填，純數字）
- C欄：狀態（選填，正常/缺貨）
- **D欄：圖片連結**（必填，完整的 https:// 網址）

#### 📌 **工作表3：庫存管理**（選用）
如果不建立，系統會預設庫存無限量

| 商品名稱 | 類型 | 當前庫存 | 初始庫存 | 狀態 |
|---------|-----|---------|---------|------|
| 六蒜包 | 商品 | 50 | 50 | 正常 |
| 丹麥手撕包 | 商品 | 30 | 30 | 正常 |

#### 📌 **工作表4：系統設定**（選用）
| 設定項目 | 值 |
|---------|---|
| 暫停接單 | 否 |

---

### 2. 部署 Google Apps Script

1. 打開您的 Google Sheets：
   ```
   https://docs.google.com/spreadsheets/d/1gf21nUj_4HTLK0zVgAb2CsHbRxcphQFdoe2LpJydjGg/edit
   ```

2. 點擊「擴充功能」→「Apps Script」

3. 將 `Google_Apps_Script_後端.js` 的完整內容貼上

4. **已自動配置！** SHEET_ID 已設定為：
   ```javascript
   const SHEET_ID = '1gf21nUj_4HTLK0zVgAb2CsHbRxcphQFdoe2LpJydjGg'; // ✅ 已自動填入
   ```

5. 點擊「部署」→「新增部署作業」
5. 選擇「網頁應用程式」
6. 設定：
   - **執行身分**：我
   - **可存取的使用者**：所有人
7. 點擊「部署」並複製網址（類似：`https://script.google.com/macros/s/...../exec`）

---

### 3. 配置前端網址

打開 `index.html`，找到第 1007 行：

```javascript
const GAS_ENDPOINT = "YOUR_GAS_ENDPOINT_HERE"; // ⚠️ 部署後填入 Google Apps Script 網址
```

將 `YOUR_GAS_ENDPOINT_HERE` 替換為剛才複製的網址：

```javascript
const GAS_ENDPOINT = "https://script.google.com/macros/s/.../exec";
```

---

### 4. 測試授權系統

授權系統已設定為 **WEB002**，系統會自動檢查授權狀態。

**測試步驟：**

1. 直接在瀏覽器打開 `index.html`
2. 檢查是否顯示載入畫面（3秒倒數）
3. 檢查是否出現授權警告（如果試用期快到期）
4. 檢查是否能正常選擇商品

**授權API：**
```
https://script.google.com/macros/s/AKfycbyDsD6V7cP239XOFvQ3mRRPILxQsBagt5UIFTJszkfsSf_1SXiDAzIav-F2dXPRU22X/exec
```

---

### 5. 測試商品載入

**預設商品列表：**
系統已預設以下商品（如果後端無法連線，會使用這些預設值）：

1. 六蒜包
2. 丹麥手撕包
3. 千層生乳吐司
4. 巧克力千層吐司
5. 金磚吐司
6. 千層蛋塔
7. 香濃乳酪酥
8. 手工丹麥蝴蝶酥
9. 烏豆沙蛋黃酥
10. 脆皮奶油烤年糕（預設價格：$25）
11. 香蒜乳酪銀絲卷

**測試：**
- 打開頁面，應該會看到商品卡片
- 如果後端已連線，商品會從 Google Sheets 載入
- 如果後端未連線，會顯示預設商品（價格顯示為「價格載入中」）

---

### 6. 後端如何讀取商品數據

✅ **已自動配置！** 後端會從「**商品圖價格**」工作表讀取：

**讀取邏輯：**
```
1. 讀取「商品圖價格」工作表（A~D欄）
2. A欄 → 商品名稱
3. B欄 → 價格
4. C欄 → 狀態
5. D欄 → 圖片連結
6. 如果有「庫存管理」工作表，則更新實際庫存
7. 如果沒有，預設庫存為 999（無限量）
```

**API 回應格式：**
```json
{
  "ok": true,
  "products": [
    {
      "name": "六蒜包",
      "price": 45,
      "img": "https://i.postimg.cc/xxx.jpg",
      "status": "正常"
    },
    ...
  ],
  "inventory": {
    "六蒜包": {
      "stock": 50,
      "initialStock": 50,
      "available": true,
      "status": "正常"
    },
    ...
  }
}
```

---

## 📝 注意事項

### ⚠️ 必須填入的資訊

1. **Google Sheets ID**（在 `Google_Apps_Script_後端.js` 第 6 行）
2. **Google Apps Script URL**（在 `index.html` 第 1007 行）

### ✅ 已配置好的資訊

- ✅ 網站ID：WEB002
- ✅ 授權API：已設定
- ✅ 品牌名稱：六蒜包·餐車
- ✅ 預設商品列表：已設定

---

## 🧪 測試清單

完成以下測試後即可交付：

- [ ] 頁面正常載入（顯示「六蒜包·餐車」）
- [ ] 商品卡片顯示正常（11個商品）
- [ ] 可以增減商品數量
- [ ] 訂單預覽即時更新
- [ ] 總金額計算正確
- [ ] 可以選擇取餐場地
- [ ] 可以選擇取餐時間
- [ ] 可以填寫備註
- [ ] 送出訂單成功（需要後端連線）
- [ ] 授權系統正常運作

---

## 📞 技術支援

如有問題，請聯繫：
- LINE：https://lin.ee/YyXagFg
- 客服團隊：快閃餐車小幫手

---

## 📄 系統資訊

- **網站ID**：WEB002
- **店名**：六蒜包·餐車訂購表單
- **訂閱方案**：試用期
- **建立日期**：2025-10-19
- **系統版本**：v2.0（烘焙糕點專用版）

