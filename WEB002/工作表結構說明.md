# 六蒜包·餐車訂購表單 - 工作表結構說明

## 📊 Google Sheets 工作表結構

您的 Google Sheets 需要包含以下工作表：

---

## 1️⃣ **商品圖價格** ✨（必須）

**工作表ID（gid）:** 1078174424  
**用途:** 儲存商品名稱、價格、圖片連結

### 欄位結構：

| 欄位 | 名稱 | 說明 | 範例 |
|-----|------|------|------|
| A | 商品名稱 | 商品的完整名稱 | 六蒜包 |
| B | 價格 | 單價（數字） | 45 |
| C | 狀態 | 商品狀態（可選） | 正常 / 缺貨 |
| D | 圖片連結 | 商品圖片網址 | https://i.postimg.cc/xxx.jpg |

### 範例數據：

```
商品名稱          | 價格 | 狀態 | 圖片連結
六蒜包           | 45   | 正常 | https://i.postimg.cc/xxx/liusuanbao.jpg
丹麥手撕包        | 50   | 正常 | https://i.postimg.cc/xxx/danmai.jpg
千層生乳吐司      | 80   | 正常 | https://i.postimg.cc/xxx/toast.jpg
金磚吐司          | 75   | 正常 | https://i.postimg.cc/xxx/gold.jpg
千層蛋塔          | 35   | 正常 | https://i.postimg.cc/xxx/eggtart.jpg
香濃乳酪酥        | 40   | 正常 | https://i.postimg.cc/xxx/cheese.jpg
手工丹麥蝴蝶酥    | 55   | 正常 | https://i.postimg.cc/xxx/butterfly.jpg
烏豆沙蛋黃酥      | 60   | 正常 | https://i.postimg.cc/xxx/mooncake.jpg
脆皮奶油烤年糕    | 25   | 正常 | https://i.postimg.cc/xxx/cake.jpg
香蒜乳酪銀絲卷    | 48   | 正常 | https://i.postimg.cc/xxx/roll.jpg
```

### ⚠️ 重要提示：

1. **第1行必須是標題行**（系統會跳過）
2. **商品名稱不可重複**
3. **價格必須是數字**（不需要加「元」或「$」符號）
4. **圖片連結必須是完整的 URL**（建議使用 postimg.cc 或 imgur 等圖床）
5. **D欄（圖片連結）是必填的**，系統會從這裡讀取圖片

---

## 2️⃣ **Form Responses 1**（已存在）

**用途:** 儲存客戶訂單（表單回應）

### 欄位結構：

| 欄位 | 名稱 | 說明 |
|-----|------|------|
| A | 時間戳記 | 訂單建立時間（自動） |
| B | 姓名 | 客戶姓名 |
| C | 電話 | 客戶電話 |
| D | 六蒜包 | 訂購數量 |
| E | 丹麥手撕包 | 訂購數量 |
| F | 千層生乳吐司&巧克力千層吐司 | 訂購數量 |
| G | 金磚吐司 | 訂購數量 |
| H | 千層蛋塔 | 訂購數量 |
| I | 香濃乳酪酥 | 訂購數量 |
| J | 手工丹麥蝴蝶酥 | 訂購數量 |
| K | 烏豆沙蛋黃酥 | 訂購數量 |
| L | 脆皮奶油烤年糕 | 訂購數量 |
| M | 香蒜乳酪銀絲卷 | 訂購數量 |
| N | 取餐時間 | 預計取餐時間 |
| O | 訂單摘要 | 格式化的訂單內容 |
| P | 總金額 | 訂單總金額 |
| Q | 其它備註 | 客戶備註 |

### ⚠️ 注意：

- 系統會自動將訂單寫入這個工作表
- 不要修改欄位順序
- 數量欄位會自動填入數字（0 表示未訂購）

---

## 3️⃣ **庫存管理**（選用）

**用途:** 管理商品庫存（如果不建立，系統會預設庫存無限量）

### 欄位結構：

| 欄位 | 名稱 | 說明 |
|-----|------|------|
| A | 商品名稱 | 必須與「商品圖價格」中的名稱一致 |
| B | 類型 | 商品類型（可選） |
| C | 當前庫存 | 目前剩餘數量 |
| D | 初始庫存 | 今日開始的庫存數量 |
| E | 狀態 | 正常 / 缺貨 |

### 範例數據：

```
商品名稱    | 類型 | 當前庫存 | 初始庫存 | 狀態
六蒜包     | 商品 | 50      | 50      | 正常
丹麥手撕包  | 商品 | 30      | 30      | 正常
千層生乳吐司| 商品 | 0       | 20      | 缺貨
```

### 功能說明：

- **當前庫存**：每次訂單會自動扣減
- **初始庫存**：用於計算剩餘比例
- **缺貨提示**：當前庫存為 0 時，前端會顯示「缺貨中」標籤
- **庫存警告**：當前庫存 ≤ 30% 時，顯示橙色警告

---

## 4️⃣ **系統設定**（選用）

**用途:** 控制系統營業狀態

### 欄位結構：

| 設定項目 | 值 |
|---------|---|
| 暫停接單 | 否 |

### 功能說明：

- **暫停接單 = 是**：系統會拒絕所有訂單
- **暫停接單 = 否**：系統正常接單

---

## 🚀 快速設置步驟

### 步驟 1：建立「商品圖價格」工作表

1. 在您的 Google Sheets 中新增工作表
2. 命名為 **商品圖價格**
3. 建立標題行：`商品名稱 | 價格 | 狀態 | 圖片連結`
4. 填入商品數據（參考上面的範例）

### 步驟 2：準備商品圖片

**建議使用免費圖床：**

1. **PostImage** (推薦)  
   網址：https://postimg.cc/  
   特點：穩定、快速、不限流量

2. **Imgur**  
   網址：https://imgur.com/  
   特點：老牌圖床、支援相簿

**上傳步驟：**
1. 訪問圖床網站
2. 上傳商品圖片
3. 複製「直接連結」（Direct Link）
4. 貼到 Google Sheets 的 D 欄

### 步驟 3：更新 Google Apps Script

1. 打開 Google Sheets
2. 點擊「擴充功能」→「Apps Script」
3. 貼上更新後的 `Google_Apps_Script_後端.js` 內容
4. 點擊「部署」

### 步驟 4：測試系統

1. 打開前端網頁
2. 檢查商品是否正確顯示（含圖片和價格）
3. 嘗試下一個測試訂單
4. 檢查「Form Responses 1」是否有新訂單

---

## 📋 檢查清單

部署前請確認：

- [ ] 「商品圖價格」工作表已建立
- [ ] 所有商品都有填入價格
- [ ] 所有商品都有圖片連結（D欄）
- [ ] 圖片連結可正常訪問
- [ ] Google Apps Script 已部署
- [ ] 前端已填入 GAS Endpoint
- [ ] 測試訂單可正常提交

---

## 🛠️ 常見問題

### Q1: 商品圖片不顯示？
**A:** 檢查圖片連結是否：
- 完整的 URL（以 https:// 開頭）
- 可公開訪問（不需要登入）
- 圖片格式正確（jpg, png, webp）

### Q2: 價格顯示為 0？
**A:** 檢查「商品圖價格」工作表：
- B 欄（價格）是否填入數字
- 不要加「元」或「$」符號
- 使用數字格式（不是文字）

### Q3: 訂單沒有寫入 Google Sheets？
**A:** 檢查：
- Google Apps Script 是否正確部署
- 前端是否填入正確的 GAS Endpoint
- 瀏覽器控制台是否有錯誤訊息

### Q4: 如何新增商品？
**A:** 
1. 在「商品圖價格」工作表新增一行
2. 填入商品名稱、價格、圖片連結
3. 在 `Google_Apps_Script_後端.js` 的 `saveOrder` 函數中新增對應欄位
4. 重新部署 Apps Script

---

## 📞 技術支援

如有任何問題，歡迎聯繫：
- LINE：https://lin.ee/YyXagFg
- 系統開發：快閃餐車小幫手

---

**最後更新：2025-10-19**

